## 一致性哈希
分片策略是为了解决单节点或者单集群容量不够用的策略。分片的策略会借助哈希算法进行路由，比如根据访问key进行hash，然后对分片数取模。
这个算法有个问题：即集群节点或者分片数变化后，会导致数据落到其他节点从而读不到数据的情况。一致性哈希算法就是为了解决这个问题的。

### 基本思路
传统的哈希算法对节点数取模，一致性哈希对2^32取模。
一致性哈希算法会构建一个哈希环的结构。节点分布在环上，请求key到来时，根据哈希结果找到环上的一个槽位，然后顺时针查找之后的节点即可。
如果发生节点数变动，仅仅会影响一个节点的数据。

### 热key
如果分片数较少，分片在哈希环上的分布式不均匀的。会导致热点数据问题。可以在哈希环上引入虚拟节点，虚拟节点是均匀的，再将虚拟节点映射到时机节点即可。
