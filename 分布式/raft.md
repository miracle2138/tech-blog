##raft算法

###简介
raft算法是分布式系统中的共识算法，其设计思路简单，更加重注工程实践。
算法可以在绝大多数节点不挂时保持一致。这里的一致只是指系统不会出现歧义或者两种值，但是这个值到底符不符合业务逻辑就不一定了。
算法中总共有三种节点：
- leader:raft算法是集中式的算法，只有leader可以接收请求
- follower:follower负责同步leader节点的日志
- candicate:follower和leader之间通过心跳机制保活，如果没有收到心跳，认为leader挂了，会发起选举

所有的数据包都有任期的概念也即term，term是raft系统的逻辑时钟

###算法包含三个核心模块：
- 领导者选举
  为了防止多个节点同时发起选举导致平票，每一个节点的超时时间是随机的。选举自己时会将term+1，发起投票rpc，其余节点进行投票。
  在同一个term里，每一个节点只能投一票。为了保证一致性，只有拥有最新数据的节点可以成为leader。否则，如果一个落后的candidate
  竞选成功，可能导致日志丢失。当然也有机制允许落后的节点成为leader，这样的leader需要从其他节点拉取日志，相对复杂一些。
- 日志复制
  leader收到写请求时，会将日志同步给follower节点。当半数以上节点收到时，leader会将数据commit。leader会记录每一个follower的进度
  以此进行同步。leader只能提交本term的日志，否则可能导致已提交的日志被覆盖。
- 集群变更
  集群配置指的是当前节点所知道的集群其他节点的信息。如果直接进行集群变更，可能同时出现两个"大多数""导致集群选举出两个leader。
  举个例子，集群a，b，c，添加d，e，此时a和b的集群配置还没有变，而d和e已经是新的了。如果此时发起选举，a竞选，能够得到b的票，
  a认为在[a,b,c]的集群里获得了大多数选票。d也可以竞选，能得到c，d，e的选票，d认为在[a,c,b,d,e]的集群里获得了大多数选票。
  raft给出了两种解法，一种是每一次只进行一个节点的调整，这样无论集群有多少节点，是奇数还是偶数，新老集群时相交的，不会同时出现两个"大多数"
